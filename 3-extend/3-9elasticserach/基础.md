https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html

# 一、基础
概述：一个Elasticsearch集群包含多个索引；一个索引包含多个类型，每个类型保存多个文档，每个文档有多个属性；
通过倒排索引提升检索速度。
索引类似MySQL的库，
类型类似MySQL的表，
文档MySQL的一行记录。

# 二、简单操作
## 2.1 根据ID检索文档
indexName/typeName/id?routing=907368116329

## 2.2 _search简单搜索
indexName/typeName/_search?q=shopId:23965954

总结：仅适合简单的查询，太复杂会导致可读性差，难以理解；使用表达式查询更灵活，可读性更高

## 2.3 使用表达式搜索
indexName/typeName/_search?source_content_type=application/json
``` 
{
  "query": {
    "match": {
      "shopName": "广州"
    }
  }
}
```

总结：结构化查询更容易理解，**source_content_type的作用是什么？？？**

## 2.4 复杂结构化查询
indexName/typeName/_search?source_content_type=application/json
```
{
  "query": {
    "bool": {
      "must": {
        "match": {
          "shopName": "广州"
        }
      },
      "filter": {
        "range": {
          "createTime": {
            "gt": "2020-10-30T01:37:57.000Z"
          }
        }
      }
    }
  }
}
```

## 2.5 全文搜索
indexName/typeName/_search?source_content_type=application/json

```
{
  "query": {
    "match": {
      "shopName": "北京海淀"
    }
  }
}
```
总结：Elasticsearch 默认按照相关性得分排序(_score分值)，即每个文档跟查询的匹配程度。

## 2.6 短语搜索
indexName/typeName/_search?source_content_type=application/json
```
{
  "query": {
    "match_phrase": {
      "shopAddress": "北京 朝阳区"
    }
  }
}
```
**【细节簇拥梳理，含义未理解】**

## 2.7 分析
概述：类似MySQL的group by功能，但是更强大
indexName/typeName/_search?source_content_type=application/json
```
// 按照shopId分组计数 
{
  "aggs": {
    "all_interests": {
      "terms": {
        "field": "shopId"
      }
    }
  }
}

// 按照shopId分组，计算每组的价格总和
{
  "aggs": {
    "all_interests": {
      "terms": {
        "field": "shopId"
      },
      "aggs": {
        "sum_price": {
          "sum": {
            "field": "price"
          }
        }
      }
    }
  }
}
```